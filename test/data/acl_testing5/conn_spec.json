{
    "sections": [
        {
            "name": "need-dns",
            "type": "subnet",
            "items": [
                "sub1-1",
                "sub2-1"
            ]
        }
    ],
    "externals": [
        {
            "name": "dns",
            "cidr": "8.8.8.8"
        }
    ],
    "required-connections": [
        {
            "src": {
                "name": "need-dns",
                "type": "section"
            },
            "dst": {
                "name": "need-dns",
                "type": "section"
            },
            "allowed-protocols": [
                {
                    "protocol": "TCP",
                    "min_destination_port": 443,
                    "max_destination_port": 443
                }
            ]
        },
        {
            "src": {
                "name": "need-dns",
                "type": "section"
            },
            "dst": {
                "name": "dns",
                "type": "external"
            }
        },
        {
            "src": {
                "name": "need-dns",
                "type": "section"
            },
            "dst": {
                "name": "sub3-1",
                "type": "subnet"
            },
            "allowed-protocols": [
                {
                    "protocol": "ICMP",
                    "type": 0,
                    "code": 0
                }
            ]
        },
        {
            "src": {
                "name": "sub1-1",
                "type": "subnet"
            },
            "dst": {
                "name": "sub1-2",
                "type": "subnet"
            },
            "allowed-protocols": [
                {
                    "protocol": "TCP",
                    "bidirectional": true
                }
            ]
        },
        {
            "src": {
                "name": "sub1-1",
                "type": "subnet"
            },
            "dst": {
                "name": "sub1-3",
                "type": "subnet"
            },
            "allowed-protocols": [
                {
                    "protocol": "TCP",
                    "bidirectional": true
                }
            ]
        },
        {
            "src": {
                "name": "sub1-2",
                "type": "subnet"
            },
            "dst": {
                "name": "sub1-3",
                "type": "subnet"
            },
            "allowed-protocols": [
                {
                    "protocol": "TCP",
                    "bidirectional": true
                }
            ]
        },
        {
            "src": {
                "name": "sub2-1",
                "type": "subnet"
            },
            "dst": {
                "name": "sub2-2",
                "type": "subnet"
            },
            "allowed-protocols": [
                {
                    "protocol": "ANY",
                    "bidirectional": true
                }
            ]
        },
        {
            "src": {
                "name": "sub3-1",
                "type": "subnet"
            },
            "dst": {
                "name": "sub2-1",
                "type": "subnet"
            },
            "allowed-protocols": [
                {
                    "protocol": "TCP",
                    "min_destination_port": 443,
                    "max_destination_port": 443
                }
            ]
        }
    ]
}