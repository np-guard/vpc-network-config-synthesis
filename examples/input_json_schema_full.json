{
    "$schema": "http://json-schema.org/draft-04/schema#",
    "$id": "github.com/np-guard/vpc-network-synthesis/v0.1",
    "type": "object",
    "properties": {
        "sections": {
            "description": "Sections are a way for users to create aggregations. These can later be used in src/dst fields.",
            "type": "array",
            "items": {
                "description": "A section is a named collection of subnets",
                "type": "object",
                "properties": {
                    "name": {
                        "type": "string"
                    },
                    "type": {
                        "type": "string",
                        "enum": [
                            "subnet",
                            "instance",
                            "nif",
                            "tag"
                        ]
                    },
                    "items": {
                        "type": "array",
                        "items": {
                            "description": "All items are of the type specified in the type property, identified by name",
                            "type": "string"
                        }
                    },
                    "fully-connected": {
                        "description": "If present then any two items in the section will be connected. If the value is true then all protocols will be allowed, otherwise user can specify a protocol list to apply to all connections",
                        "oneOf": [
                            {
                                "type": "boolean",
                                "default": false
                            },
                            {
                                "$ref": "definitions.json#/definitions/schemas/connections"
                            }
                        ]
                    }
                },
                "required": [
                    "name",
                    "type",
                    "items"
                ]
            }
        },
        "externals": {
            "type": "array",
            "description": "Externals are a way for users to name IP addresses or ranges external to the VPC. These are later used in src/dst definitions.",
            "items": {
                "type": "object",
                "properties": {
                    "name": {
                        "type": "string"
                    },
                    "cidr": {
                        "description": "Acceptable format is standard CIDR notation, e.g. \"192.0.0.0/16\" or a single IP Address, e.g. \"192.168.32.35\"",
                        "type": "string"
                    }
                },
                "required": [
                    "name",
                    "cidr"
                ]
            }
        },
        "required-connections": {
            "type": "array",
            "description": "A list of required connections",
            "items": {
                "type": "object",
                "properties": {
                    "src": {
                        "$ref": "definitions.json#/definitions/schemas/endpoint"
                    },
                    "dst": {
                        "$ref": "definitions.json#/definitions/schemas/endpoint"
                    },
                    "connection-type": {
                        "$ref": "definitions.json#/definitions/schemas/connections"
                    }
                },
                "additionalProperties": false
            }
        }
    },
    "required": [
        "required-connections"
    ]
}